<ng-container *ngIf="field && document">
    <ng-container *ngIf="document.highlight?.[field.name]; else unhighlightedRow">
        @for (item of document.highlight[field.name]; track item; let last = $last) {
            @let segments = item | highlightSnippet;
            <div class="break-word" style="white-space: pre-wrap;">
            @for (segment of segments; track segment) {
                @if (segment.highlight)
                {<mark class="highlight" ngPreserveWhitespaces>{{segment.content}}</mark>}
                @else
                {<ng-container ngPreserveWhitespaces>{{segment.content}}</ng-container>}

            }
            <hr *ngIf="!last">
        </div>
        }
    </ng-container>
    <ng-template #unhighlightedRow>
        <div class="break-word"
            [innerHtml]="document.fieldValue(field) | snippet:250">
        </div>
    </ng-template>
</ng-container>
